# 複素微分と正則関数

複素数の意味で微分可能な関数を**正則関数**という。微分の定義は表面的にはいつもの(実関数の)微分と同じだが、複素数の場合は実部方向と虚部方向を考えないといけないため、ある意味で条件が増えることになる。

## 定義とはじめの例

まずは定義を紹介する。

!!! definition "定義"
    $\Omega \subset \mathbb{C}$ を領域(連結な開集合)とする。関数 $f: \Omega \to \mathbb{C}$ が $z \in \Omega$ において **複素微分可能**であるとは、次の極限が存在することをいう：
    
    $$\lim_{w \in \Omega \setminus \{z\},  w \to z}\frac{f(w)-f(z)}{w-z} $$
    
    ここで、極限は「$w$ が $\Omega$ 内で $w \neq z$ を保ちながら $z$ に近づくとき」という意味である。このとき、上記の極限を$f'(z)$ と書く。

    $f$ が **正則** であるとは、$f$ が任意の $z \in \Omega$ に対して複素微分可能であることをいう。

!!! remark "注意"
    「領域」とは、「連結な開集合」のことをいう。「連結」は、集合がひとつながりになっていることを表す。また、「開集合」は集合が境界の点を含まないことをいう。
    
    これらの用語の正確な定義については別のページで…

!!! remark "注意"
    極限の部分を「$\varepsilon$-$\delta$」を用いて正確に述べると、以下のようになる：
    
    $f$ が正則であるとは、任意の $z \in \Omega$ に対して、次の条件が成り立つことをいう。
    
    - ある複素数 $\alpha \in \mathbb{C}$ が存在して、任意の $\varepsilon>0$ に対して、ある $\delta >0$ が存在して、任意の$w \in \Omega \setminus \{z\}$に対して、 
    $$|w-z|< \delta \Longrightarrow \left|\frac{f(w) - f(z)}{w-z} - \alpha\right| < \varepsilon $$
    が成り立つ。

正則関数の例を紹介する。

!!! example "例"
    $f(z) = z^2$ は、$\mathbb{C}$ 上の正則関数である。実際、任意の $z \in \mathbb{C}$ に対して、
    
    $$ \begin{align*} \lim_{w \to z} \frac{f(w) - f(z)}{w-z} &= \lim_{w \to z} \frac{w^2 - z^2}{w-z}\\
    &= \lim_{w \to z} \frac{(w-z)(w+z)}{w-z}\\
    &= \lim_{w \to z} (w+z)\\
    &= z + z = 2z
    \end{align*} $$
    
    のようにして極限の存在が確かめられる。ここでは極限の表記を少し省略したが、$\lim$ の中の $w$ は $w \neq z$ となるように動かすので、分数の分母や分子にある $w-z$ は $0$ にならないことに注意する。
    
    この計算から、$f'(z) = 2z$ であることもわかる。

!!! remark "注意"
    実関数の微分では、$g(x)=x^2$ の微分は $g'(x) = 2x$ となるのであった。これも微分の定義の極限を計算することで示すことができるのだが、どのように計算したか思い出してみよう。$x \in \mathbb{R}$ に対して、

    $$ \begin{align*} \lim_{y \to x} \frac{g(y) - g(x)}{y-x} &= \lim_{y \to x} \frac{y^2 - x^2}{y-x}\\
    &= \lim_{y \to x} \frac{(y-x)(y+x)}{y-x}\\
    &= \lim_{y \to x} (y+x)\\
    &= x + x = 2x
    \end{align*} $$

    となる。この計算は、複素関数 $f(z) = z^2$ の微分の計算とまったく同じであることがわかる。同様に、例えば(実数係数)多項式の定める関数 $f$ の微分も、実関数だと思ったときと複素関数だと思ったときでまったく同じ計算により得ることができる。

関数 $f(z) = z^2$ によって、複素平面上の点が別の複素平面に移る様子をうまく想像できるだろうか？ 複素関数は一般に平面(の部分集合)から平面への写像となるため、実関数のグラフのように分かりやすく図示することが難しい。しかし、正則関数の性質を考えるときは、具体的な関数がどのように振るまうかを把握しておくことはとても有用である。別のページで $f(z) = z^2$ などの複素関数の可視化を行う(そのうち……)。

## 正則でない関数

正則でない関数の例を挙げる。

!!! example "例"
    (1) 複素共役を取る関数 $f(z) = \overline{z}$ は正則ではない。$z = 0$ における複素微分が存在しないことを確かめよう。まず、実数 $x$ に対しては $f(x) = \overline{x} = x$ なので、実軸方向から極限を取ると、
    $$\lim_{x\in \mathbb{R}, x \to 0}\frac{f(x) - f(0)}{x-0} = \lim_{x \to 0}\frac{x}{x} = 1 $$
    となる。一方で、$z$ が純虚数のときは、実数 $y$ に対して$z = iy$ と書くと、$f(iy) = \overline{iy} = -iy$ である。したがって、
    $$\lim_{y\in \mathbb{R}, y \to 0}\frac{f(iy) - f(0)}{iy-0} = \lim_{y \to 0}\frac{-iy}{iy} = -1 $$
    となる。このように、$0$への近づけ方によって値が変わってしまうので、複素微分は存在しない。すなわち、$f(z) = \overline{z}$ は正則ではない。

    (2) 実部を取る関数 $f(z) = \mathrm{Re}(z)$ は正則ではない。(1)と同様に、$z=0$ における複素微分が存在しないことを確かめよう。実数 $x, y$ に対して $f(x) = \mathrm{Re} (x) = x$, $f(iy) = \mathrm{Re} (iy) = 0$ であるから、
    $$\lim_{x\in \mathbb{R}, x \to 0}\frac{f(x) - f(0)}{x-0} = \lim_{x \to 0}\frac{x}{x} = 1 $$
    $$\lim_{y\in \mathbb{R}, y \to 0}\frac{f(y) - f(0)}{y-0} = \lim_{y \to 0}\frac{0}{y} = 0 $$
    となり、複素微分は存在しない。
    
(次のページで詳しく述べるつもりだが、)微分可能であるということはざっくりいうと「めちゃくちゃ拡大したらだいたい線形(=複素数倍)に見える」という気持ちである。複素共役や実部を取る関数が正則でないということは、どれだけ拡大しても線形に見えることはないということを意味している。

## 複素微分の性質

複素微分に関する基本的な性質をいくつか挙げる。

### 定数関数、恒等関数
まず、基本的なつぎの二つの関数が正則であることを確認しよう：

!!! proposition "命題"
    (1) 定数関数は $\mathbb{C}$ 上の正則関数である。

    (2) 恒等関数 $f(z) = z$ は $\mathbb{C}$ 上の正則関数である。

**証明** (微分の練習として、下の証明を読む前に自分でやってみることをおすすめします。)

(1) $c \in \mathbb{C}$ として、$f(z) = c$ の正則性を証明する。 $z \in \mathbb{C}$ に対して、

$$\lim_{w \to z} \frac{f(w)-f(z)}{w-z} = \lim_{w \to z} \frac{c-c}{w-z} = \lim_{w \to z} 0 = 0 $$

であるから、定数関数は正則である。

(2) $z \in \mathbb{C}$ に対して、

$$\lim_{w \to z} \frac{f(w)-f(z)}{w-z} = \lim_{w \to z} \frac{w-z}{w-z} = \lim_{w \to z} 1 = 1 $$

であるから、恒等関数は正則である。 $\square$

### 四則演算
正則関数の和・差・積・商は正則である。

!!! proposition "命題"
    $\Omega \subset \mathbb{C}$ を領域とし、$f, g: \Omega \to \mathbb{C}$ を正則関数とする。このとき、 
    
    (1) $f + g$, $f-g$, $fg$ は正則関数である。その微分は、それぞれ
    $$ (f+g)' = f' + g' $$
    $$ (f-g)' = f' - g' $$
    $$ (fg)' = f'g + fg' $$
    となる。

    (2) $f$ が $\Omega$ 上で $f(z)=0$ となる点 $z$ をもたないとすると、$1/f$ も正則関数である。その微分は、
    $$ (1/f)' = f'/f^2 $$
    となる。

これらの公式は、実関数のときと全く同じであることに注意しよう。

**証明**

(1) まず、和と差について証明する。$z \in \Omega$ に対して、

$$ \begin{align*}&\lim_{w \to z} \frac{(f(w) \pm g(w)) - (f(z) \pm g(z))}{w-z} \\ =& \lim_{w \to z} \frac{f(w) - f(z)}{w-z} \pm \lim_{w \to z} \frac{g(w) - g(z)}{w-z} \\
= & f'(z) \pm g'(z) \end{align*}$$

より、$f \pm g$ は正則であることがわかる。

次に、積について証明する。$z \in \Omega$ に対して、

$$ \begin{align*}&\lim_{w \to z} \frac{(f(w)  g(w)) - (f(z) g(z))}{w-z} \\ =& \lim_{w \to z} \frac{f(w)g(w) - f(w)g(z)}{w-z} + \lim_{w \to z} \frac{f(w)g(z) - f(z)g(z)}{w-z} \\
 =& \lim_{w \to z} \left(f(w) \cdot \frac{g(w) - g(z)}{w-z}\right) + \lim_{w \to z} \left(\frac{f(w) - f(z)}{w-z} \cdot g(z) \right)\\ 
= & f'(z) g(z) + f(z) g'(z) \end{align*} $$

より、$fg$ は正則であることがわかる。

(2) (1)で積の正則性を示したので、$1/f$が正則であることを示せば十分である。

$z \in \Omega$ に対して、

$$ \begin{align*}&\lim_{w \to z}\frac{1/f(w) - 1/f(z)}{w-z}\\
=& \lim_{w\to z} \frac{f(z)-f(w)}{f(w)f(z)(w-z)}\\
=& -\frac{f'(z)}{f(z)^2}\end{align*} $$

より、$1/g$ は正則であることがわかる。$\square$

## まとめ
!!! summary "まとめ"
    - 正則関数の定義といくつかの例・反例を紹介した。
    - 定数・恒等関数の正則性と、正則関数の和・差・積・商(分母が $0$ にならない範囲で)の正則性を示した。